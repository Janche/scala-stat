+----------------------------------------------+--------------------------+-------------------------------+----------------------------+-----------------------------+----------------------------+----------------------------+-------------------------------+----------------------------------+------------------------------+--------------------------------+--------------------------+-----------------------------------+----------------------------+--------------------------------+---------------------------------+--------------------------------+------------------------------+-----------------------------+---------------------------------+---------------------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+------------------------------+-----------------------+----------------------------+-------------------------+-------------------------+--------------------------+------------------------+
|            inde_h5_event_pre.udid            | inde_h5_event_pre.appid  | inde_h5_event_pre.devicetype  | inde_h5_event_pre.channel  | inde_h5_event_pre.usertype  | inde_h5_event_pre.sceneid  | inde_h5_event_pre.version  | inde_h5_event_pre.actiontype  | inde_h5_event_pre.localtimezone  | inde_h5_event_pre.localtime  | inde_h5_event_pre.sessionflag  | inde_h5_event_pre.level  | inde_h5_event_pre.customdotevent  | inde_h5_event_pre.groupid  | inde_h5_event_pre.confversion  | inde_h5_event_pre.actionsource  | inde_h5_event_pre.devicemodel  | inde_h5_event_pre.osversion  | inde_h5_event_pre.currency  | inde_h5_event_pre.purchasecost  | inde_h5_event_pre.purchaseitem  | inde_h5_event_pre.v1  | inde_h5_event_pre.v2  | inde_h5_event_pre.v3  | inde_h5_event_pre.v4  | inde_h5_event_pre.v5  | inde_h5_event_pre.v6  | inde_h5_event_pre.v7  | inde_h5_event_pre.v8  | inde_h5_event_pre.timestamp  | inde_h5_event_pre.ip  | inde_h5_event_pre.country  | inde_h5_event_pre.city  | inde_h5_event_pre.year  | inde_h5_event_pre.month  | inde_h5_event_pre.day  |
+----------------------------------------------+--------------------------+-------------------------------+----------------------------+-----------------------------+----------------------------+----------------------------+-------------------------------+----------------------------------+------------------------------+--------------------------------+--------------------------+-----------------------------------+----------------------------+--------------------------------+---------------------------------+--------------------------------+------------------------------+-----------------------------+---------------------------------+---------------------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+------------------------------+-----------------------+----------------------------+-------------------------+-------------------------+--------------------------+------------------------+
| Ga_htBZhN9p7-LQEqUijzTSvd1lXGxhFa8IOTuhBqXs  | com.libii.crushallh5     | Android                       | VIVO_H5                    | new                         | -1                         | 1.0.0                      | customDot                     | GMT+08:00                        | 2021-09-13 00:00:00          | NULL                           | 9                        | nativebanner                      | 1001                       | NULL                           | NULL                            | V2057A                         | Android 10                   | NULL                        | NULL                            | NULL                            | 1                     | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | 1631462400814                | 171.111.54.23         | CN                         | Nanning                 | 2021                    | 9                        | 13                     |
| Ga_htBZhN9p7-LQEqUijzTSvd1lXGxhFa8IOTuhBqXs  | com.libii.crushallh5     | Android                       | VIVO_H5                    | new                         | -1                         | 1.0.0                      | customDot                     | GMT+08:00                        | 2021-09-13 00:00:00          | NULL                           | 9                        | nativebanner                      | 1001                       | NULL                           | NULL                            | V2057A                         | Android 10                   | NULL                        | NULL                            | NULL                            | 2                     | 1                     | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | 1631462400855                | 171.111.54.23         | CN                         | Nanning                 | 2021                    | 9                        | 13                     |
| nvE8PcPC5joeZhcgSSQ0m10Y5FZi789wr5LUzulxEpM  | H5G35                    | Android                       | VIVO_H5                    | old                         | 1000                       | 0.4.4                      | sessionIn                     | GMT+08:00                        | 2021-09-13 00:00:04          | 5                              | 5                        | NULL                              | 0                          | 440                            | NULL                            | NULL                           | NULL                         | NULL                        | NULL                            | NULL                            | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | 1631462405256                | 112.97.55.150         | CN                         | Shenzhen                | 2021                    | 9                        | 13                     |
| 1115665873                                   | com.libii.h5g200         | Android                       | OPPO_H5                    | new                         | -1                         | 1.0.7                      | customDot                     | GMT+08:00                        | 2021-09-13 00:00:06          | NULL                           | 2                        | nativebanner                      | 1071                       | NULL                           | NULL                            | PBAM00                         | Android 8.1.0                | NULL                        | NULL                            | NULL                            | 2                     | 1                     | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | 1631462406625                | 221.192.180.214       | CN                         | Beijing                 | 2021                    | 9                        | 13                     |
| UaIK-MkXdM3YjyU8U05zYVvjGy-5zcBa5MzhizkbkOY  | com.libii.crushallh5     | Android                       | VIVO_H5                    | new                         | -1                         | 1.0.0                      | customDot                     | GMT+08:00                        | 2021-09-13 00:00:14          | NULL                           | 1                        | noblePack                         | 1001                       | NULL                           | NULL                            | V1930A                         | Android 9                    | NULL                        | NULL                            | NULL                            | 0                     | 1                     | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | NULL                  | 1631462415377                | 183.93.3.155          | CN                         | Wuhan                   | 2021                    | 9                        | 13                     |
+----------------------------------------------+--------------------------+-------------------------------+----------------------------+-----------------------------+----------------------------+----------------------------+-------------------------------+----------------------------------+------------------------------+--------------------------------+--------------------------+-----------------------------------+----------------------------+--------------------------------+---------------------------------+--------------------------------+------------------------------+-----------------------------+---------------------------------+---------------------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+------------------------------+-----------------------+----------------------------+-------------------------+-------------------------+--------------------------+------------------------+



CREATE EXTERNAL TABLE `inde_h5_event_pre`(         |
|   `udid` string,                                   |
|   `appid` string,                                  |
|   `devicetype` string,                             |
|   `channel` string,                                |
|   `usertype` string,                               |
|   `sceneid` string,                                |
|   `version` string,                                |
|   `actiontype` string,                             |
|   `localtimezone` string,                          |
|   `localtime` string,                              |
|   `sessionflag` int,                               |
|   `level` string,                                  |
|   `customdotevent` string,                         |
|   `groupid` bigint,                                |
|   `confversion` string,                            |
|   `actionsource` string,                           |
|   `devicemodel` string,                            |
|   `osversion` string,                              |
|   `currency` string,                               |
|   `purchasecost` double,                           |
|   `purchaseitem` string,                           |
|   `v1` string,                                     |
|   `v2` string,                                     |
|   `v3` string,                                     |
|   `v4` string,                                     |
|   `v5` string,                                     |
|   `v6` string,                                     |
|   `v7` string,                                     |
|   `v8` string,                                     |
|   `timestamp` bigint,                              |
|   `ip` string,                                     |
|   `country` string,                                |
|   `city` string)                                   |
| PARTITIONED BY (                                   |
|   `year` int,                                      |
|   `month` int,                                     |
|   `day` int)                                       |
| ROW FORMAT SERDE                                   |
|   'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'  |
| STORED AS INPUTFORMAT                              |
|   'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'  |
| OUTPUTFORMAT                                       |
|   'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' |
| LOCATION                                           |
|   'hdfs://statisticservice/input/log_entry/inde_h5_event_pre' |
| TBLPROPERTIES (                                    |
|   'presto_query_id'='20210714_020909_00011_fzkzv',  |
|   'presto_version'='0.256-1b6276d',                |
|   'spark.sql.create.version'='2.2 or prior',       |
|   'spark.sql.sources.schema.numPartCols'='3',      |
|   'spark.sql.sources.schema.numParts'='1',         |
|   'spark.sql.sources.schema.part.0'='{"type":"struct","fields":[{"name":"udid","type":"string","nullable":true,"metadata":{}},{"name":"appId","type":"string","nullable":true,"metadata":{}},{"name":"deviceType","type":"string","nullable":true,"metadata":{}},{"name":"channel","type":"string","nullable":true,"metadata":{}},{"name":"userType","type":"string","nullable":true,"metadata":{}},{"name":"sceneId","type":"string","nullable":true,"metadata":{}},{"name":"version","type":"string","nullable":true,"metadata":{}},{"name":"actionType","type":"string","nullable":true,"metadata":{}},{"name":"localTimeZone","type":"string","nullable":true,"metadata":{}},{"name":"localTime","type":"string","nullable":true,"metadata":{}},{"name":"sessionFlag","type":"integer","nullable":true,"metadata":{}},{"name":"level","type":"string","nullable":true,"metadata":{}},{"name":"customDotEvent","type":"string","nullable":true,"metadata":{}},{"name":"groupId","type":"long","nullable":true,"metadata":{}},{"name":"confVersion","type":"string","nullable":true,"metadata":{}},{"name":"actionsource","type":"string","nullable":true,"metadata":{}},{"name":"deviceModel","type":"string","nullable":true,"metadata":{}},{"name":"osVersion","type":"string","nullable":true,"metadata":{}},{"name":"currency","type":"string","nullable":true,"metadata":{}},{"name":"purchasecost","type":"double","nullable":true,"metadata":{}},{"name":"purchaseitem","type":"string","nullable":true,"metadata":{}},{"name":"v1","type":"string","nullable":true,"metadata":{}},{"name":"v2","type":"string","nullable":true,"metadata":{}},{"name":"v3","type":"string","nullable":true,"metadata":{}},{"name":"v4","type":"string","nullable":true,"metadata":{}},{"name":"v5","type":"string","nullable":true,"metadata":{}},{"name":"v6","type":"string","nullable":true,"metadata":{}},{"name":"v7","type":"string","nullable":true,"metadata":{}},{"name":"v8","type":"string","nullable":true,"metadata":{}},{"name":"timestamp","type":"long","nullable":true,"metadata":{}},{"name":"ip","type":"string","nullable":true,"metadata":{}},{"name":"country","type":"string","nullable":true,"metadata":{}},{"name":"city","type":"string","nullable":true,"metadata":{}},{"name":"year","type":"integer","nullable":true,"metadata":{}},{"name":"month","type":"integer","nullable":true,"metadata":{}},{"name":"day","type":"integer","nullable":true,"metadata":{}}]}',  |
|   'spark.sql.sources.schema.partCol.0'='year',     |
|   'spark.sql.sources.schema.partCol.1'='month',    |
|   'spark.sql.sources.schema.partCol.2'='day',      |
|   'transient_lastDdlTime'='1630052349')